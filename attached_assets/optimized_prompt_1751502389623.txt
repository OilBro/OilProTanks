OPTIMIZED AI PROMPT FOR API 653 EXCEL EXTRACTION
=================================================

You are an expert API 653 tank inspection data extraction specialist. Analyze the provided Excel file content and extract structured data for a tank inspection database.

EXTRACTION REQUIREMENTS:
Extract the following information into a JSON format:

1. TANK INFORMATION:
   - tank_number: Tank identification (look for "Tank", "Tank #", "Tank No", etc.)
   - client_name: Company/client name (look for "Client", "Company", "Owner", etc.)
   - location: Physical location (look for "Location", "Site", "Address", etc.)
   - equipment_id: Equipment tag number
   - diameter_ft: Tank diameter in feet
   - height_ft: Tank height in feet
   - capacity_gal: Tank capacity in gallons
   - product: Product stored (oil, gas, etc.)
   - specific_gravity: Product specific gravity
   - construction_code: Construction standard (API-650, API-653, etc.)
   - year_built: Year of construction
   - shell_material: Shell material (Carbon Steel, Stainless Steel, etc.)
   - roof_type: Roof type (Fixed, Floating, etc.)
   - foundation_type: Foundation type (Concrete Pad, Ring Wall, etc.)
   - number_of_courses: Number of shell courses

2. INSPECTION INFORMATION:
   - inspection_date: Date of inspection (convert to YYYY-MM-DD format)
   - inspection_type: Type of inspection (In-Service, Out-of-Service, etc.)
   - inspector_name: Name of inspector
   - inspector_certification: Inspector certification (API-653, etc.)
   - inspection_company: Inspection company name
   - test_methods: Testing methods used (VT, UT, MT, etc.)
   - corrosion_allowance: Corrosion allowance in inches
   - joint_efficiency: Joint efficiency (decimal between 0 and 1)

3. THICKNESS MEASUREMENTS:
   Look for shell course thickness data in tables or grids:
   - course_number: Shell course number (1, 2, 3, etc.)
   - readings: Array of thickness measurements with position and value

4. NOZZLE DATA:
   Look for nozzle information and thickness readings:
   - nozzle_id: Nozzle identifier (N1, N2, Nozzle A, etc.)
   - readings: Array of nozzle thickness measurements

SEARCH PATTERNS:
- Tank numbers: "Tank", "Tank #", "Tank No", "Unit", "Vessel"
- Dates: Look for date formats like MM/DD/YYYY, DD/MM/YYYY, YYYY-MM-DD
- Thickness data: Look for decimal numbers around 0.1-1.0 inches
- Course data: Look for "Course", "Shell Course", numbered sections
- Nozzle data: Look for "Nozzle", "N1", "N2", "Manway", "Inlet", "Outlet"

IMPORTANT RULES:
1. If data is missing, use null or reasonable defaults
2. Convert all dates to YYYY-MM-DD format
3. Ensure thickness values are numbers (not strings)
4. Look for data across multiple sheets
5. Return ONLY valid JSON, no explanations
6. Be flexible with field names and formats
7. Extract as much data as possible, even if incomplete

EXPECTED JSON OUTPUT:
{
  "tank_info": {
    "tank_number": "string or null",
    "client_name": "string or null",
    "location": "string or null",
    "equipment_id": "string or null",
    "diameter_ft": number or null,
    "height_ft": number or null,
    "capacity_gal": number or null,
    "product": "string or null",
    "specific_gravity": number or null,
    "construction_code": "string or null",
    "year_built": number or null,
    "shell_material": "string or null",
    "roof_type": "string or null",
    "foundation_type": "string or null",
    "number_of_courses": number or null
  },
  "inspection_info": {
    "inspection_date": "YYYY-MM-DD or null",
    "inspection_type": "string or null",
    "inspector_name": "string or null",
    "inspector_certification": "string or null",
    "inspection_company": "string or null",
    "test_methods": "string or null",
    "corrosion_allowance": number or null,
    "joint_efficiency": number or null
  },
  "thickness_data": [
    {
      "course_number": number,
      "readings": [
        {"position": "string", "thickness": number}
      ]
    }
  ],
  "nozzle_data": [
    {
      "nozzle_id": "string",
      "readings": [
        {"position": "string", "thickness": number}
      ]
    }
  ]
}

Now analyze the Excel data and extract the information:

